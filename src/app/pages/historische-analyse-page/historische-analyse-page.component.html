<div class="page-container">
  <h1 class="sensor_headline">
    <i class="fas fa-chart-line"></i>
    Historische Analyse
  </h1>

  <!-- Config section in a row -->
  <div class="config-section" [formGroup]="timeForm">
    <div class="config-stack">
      <div *ngFor="let cfg of configs; let i = index" class="stat-card">
        <app-chart-config-row [config]="cfg" (configChange)="onConfigChange(i, $event)">
        </app-chart-config-row>
      </div>
    </div>
    <div class="stat-card datepicker-card">
      <app-date-time-picker formControlName="dateTimeRange"></app-date-time-picker>

      <!-- Quick Range Buttons in Page -->
      <div class="quick-buttons">
        <button mat-stroked-button type="button" (click)="applyQuick(QuickRangeKey.LAST_WEEK)">
          Neues Diagramm zur letzten Woche
        </button>
        <button mat-stroked-button type="button" (click)="applyQuick(QuickRangeKey.LAST_MONTH)">
          Neues Diagramm zum vorigen Monat
        </button>
        <button mat-stroked-button type="button" (click)="applyQuick(QuickRangeKey.LAST_90_DAYS)">
          Neues Diagramm zu den letzten 90 Tagen
        </button>
      </div>

      <button mat-raised-button color="primary" (click)="loadCharts()">
        <i class="fas fa-plus"></i> Neue Charts hinzuf√ºgen
      </button>
      <mat-error *ngIf="errorMessage">{{ errorMessage }}</mat-error>
    </div>
  </div>

  <!-- Charts below config -->
  <div class="charts-section">
    <div class="charts-grid">
      <div
        *ngFor="let chart of savedCharts"
        cdkDrag
        class="chart-card resizable"
        cdkDragBoundary=".charts-grid"
      >
        <app-chart-panel [config]="chart" (remove)="removeChart($event)"></app-chart-panel>
        <div class="resize-handle bottom-right" cdkDragHandle></div>
      </div>
    </div>
  </div>
</div>
